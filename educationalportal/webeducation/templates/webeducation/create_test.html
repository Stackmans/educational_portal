{% extends 'base.html' %}
{% load static %}

{% block main_content %}
<div class="container">
    <h1 class="h3 mb-3">Create Test</h1>
    <form method="post" enctype="multipart/form-data">
        {% csrf_token %}
        {{ form.as_p }}

        <div class="form-group">
            <label for="subject" class="form-label">Subject:</label>
            <select name="subject" class="form-select" required>
                <option value="" selected disabled>Select Subject</option>
                {% for subject in user.teacher.subjects.all %}
                    <option value="{{ subject.id }}">{{ subject.name }}</option>
                {% endfor %}
            </select>
        </div>

        <hr>

        <h2 class="h4 mb-3">Add Questions</h2>
        <div id="questions">
            <div class="question form-group">
                <label for="question" class="form-label">Question:</label>
                <input type="text" name="question1" class="form-control mb-2" style="background-color: #b59a7a;" required>
                <div class="form-inline">
                    <label for="optionA" class="form-label mr-2">A:</label>
                    <input type="text" name="optionA1" class="form-control mb-2 mr-2" style="background-color: #b59a7a;" required>
                    <input type="radio" name="correct_option1" value="A" required>
                </div>
                <div class="form-inline">
                    <label for="optionB" class="form-label mr-2">B:</label>
                    <input type="text" name="optionB1" class="form-control mb-2 mr-2" style="background-color: #b59a7a;" required>
                    <input type="radio" name="correct_option1" value="B" required>
                </div>
                <div class="form-inline">
                    <label for="optionC" class="form-label mr-2">C:</label>
                    <input type="text" name="optionC1" class="form-control mb-2 mr-2" style="background-color: #b59a7a;" required>
                    <input type="radio" name="correct_option1" value="C" required>
                </div>
                <div class="form-inline">
                    <label for="optionD" class="form-label mr-2">D:</label>
                    <input type="text" name="optionD1" class="form-control mb-2 mr-2" style="background-color: #b59a7a;" required>
                    <input type="radio" name="correct_option1" value="D" required>
                </div>
                <button type="button" onclick="removeQuestion(this)" class="btn btn-sm btn-danger">Remove</button>
            </div>
        </div>
        <button type="button" onclick="addQuestion()" class="btn btn-sm btn-primary mb-3">Add Question</button>

        <hr>

        <button type="submit" class="btn btn-sm btn-success">Create Test</button>
    </form>
</div>

<script>
    function addQuestion() {
        const questionDiv = document.createElement('div');
        questionDiv.className = 'question form-group';
        const questionCount = document.querySelectorAll('.question').length + 1;
        questionDiv.innerHTML = `
            <label for="question" class="form-label">Question:</label>
            <input type="text" name="question${questionCount}" class="form-control mb-2" style="background-color: #b59a7a;" required>
            <div class="form-inline">
                <label for="optionA" class="form-label mr-2">A:</label>
                <input type="text" name="optionA${questionCount}" class="form-control mb-2 mr-2" style="background-color: #b59a7a;" required>
                <input type="radio" name="correct_option${questionCount}" value="A" required>
            </div>
            <div class="form-inline">
                <label for="optionB" class="form-label mr-2">B:</label>
                <input type="text" name="optionB${questionCount}" class="form-control mb-2 mr-2" style="background-color: #b59a7a;" required>
                <input type="radio" name="correct_option${questionCount}" value="B" required>
            </div>
            <div class="form-inline">
                <label for="optionC" class="form-label mr-2">C:</label>
                <input type="text" name="optionC${questionCount}" class="form-control mb-2 mr-2" style="background-color: #b59a7a;" required>
                <input type="radio" name="correct_option${questionCount}" value="C" required>
            </div>
            <div class="form-inline">
                <label for="optionD" class="form-label mr-2">D:</label>
                <input type="text" name="optionD${questionCount}" class="form-control mb-2 mr-2" style="background-color: #b59a7a;" required>
                <input type="radio" name="correct_option${questionCount}" value="D" required>
            </div>
            <button type="button" onclick="removeQuestion(this)" class="btn btn-sm btn-danger">Remove</button>
        `;
        document.getElementById('questions').appendChild(questionDiv);
    }

    function removeQuestion(button) {
        const questionDiv = button.parentElement;
        questionDiv.remove();
    }
</script>
{% endblock %}

